# CloudTune Backend

Backend для облачного музыкального плеера CloudTune.

## Особенности

- Аутентификация пользователей с использованием JWT
- Загрузка и хранение музыкальных файлов
- Управление пользовательской библиотекой
- Создание и управление плейлистами
- Защита файлов - доступ только владельцу

## Установка и запуск

### Локальный запуск

1. Установите Go (версия 1.24 или выше)
2. Установите Docker и Docker Compose
3. Скопируйте `.env.example` в `.env` и настройте переменные окружения
4. Запустите сервисы:

```bash
docker-compose up --build
```

Сервер будет доступен по адресу `http://localhost:8080`

### Запуск в продакшене

1. Настройте домен (например, `api.api-mp3-player.ru`)
2. Обновите конфигурацию nginx
3. Запустите с помощью docker-compose

## API Эндпоинты

### Аутентификация

- `POST /auth/register` - регистрация пользователя
- `POST /auth/login` - вход пользователя

### Работа с песнями

- `POST /api/songs/upload` - загрузка новой песни (требует аутентификации)
- `GET /api/songs/library` - получить библиотеку пользователя (требует аутентификации)
- `GET /api/songs/:id` - получить информацию о песне (требует аутентификации)

### Работа с плейлистами

- `POST /api/playlists` - создать новый плейлист (требует аутентификации)
- `GET /api/playlists` - получить плейлисты пользователя (требует аутентификации)
- `POST /api/playlists/:playlist_id/songs/:song_id` - добавить песню в плейлист (требует аутентификации)
- `GET /api/playlists/:playlist_id/songs` - получить песни из плейлиста (требует аутентификации)

## Структура проекта

```
backend/
├── cmd/
│   └── api/
│       └── main.go          # Основной файл приложения
├── internal/
│   ├── database/            # Работа с базой данных
│   ├── handlers/            # Обработчики HTTP запросов
│   ├── middleware/          # Middleware (например, аутентификация)
│   ├── models/              # Модели данных
│   └── utils/               # Вспомогательные функции
├── uploads/                 # Загруженные файлы (создается автоматически)
├── go.mod                   # Зависимости Go
├── go.sum                   # Чек-суммы зависимостей
├── docker-compose.yml       # Конфигурация Docker
└── Dockerfile.dev           # Dockerfile для разработки
```

## Технологии

- Go (Golang)
- PostgreSQL
- Gin Framework
- JWT для аутентификации
- Docker для контейнеризации
- Nginx для reverse proxy

## Деплой на сервер

1. Скопируйте проект на сервер
2. Обновите `.env` файл с продакшен параметрами
3. Запустите с помощью `docker-compose up -d`
4. Настройте nginx как reverse proxy (пример конфигурации уже предоставлен)

## Безопасность

- Все чувствительные эндпоинты защищены JWT токенами
- Проверка типа загружаемых файлов
- Ограничение доступа к файлам - только владелец может управлять своими файлами
- Использование безопасного хранения паролей (bcrypt)